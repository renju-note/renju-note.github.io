{"version":3,"sources":["components/preference.ts","rule/foundation.ts","rule/board/row.ts","rule/board/line.ts","rule/board/square.ts","rule/board/forbidden.ts","rule/board/board.ts","rule/game/game.ts","components/system.ts","components/Board/Base.tsx","components/Board/Properties.tsx","components/Board/Stones.tsx","components/Board/index.tsx","components/Controller/PreferencePopover.tsx","components/Controller/index.tsx","components/state.ts","components/Main.tsx","components/App.tsx","serviceWorker.ts","index.tsx"],"names":["Preference","init","showIndices","showOrders","emphasizeLastMove","showForbiddens","showPropertyRows","showPropertyEyes","undefined","this","PreferenceContext","createContext","loadPreference","localStoragePreference","partial","JSON","parse","e","console","log","equal","a","b","xCode","x","charAt","yCode","toString","code","y","point","indexOf","toUpperCase","parseInt","slice","BLACK_PATTERNS","two","row","kind","size","eyes","rowStart","blacks","whites","blmask","whmask","closedThree","three","four","five","overline","WHITE_PATTERNS","Line","rows","Error","RowsProxy","black","i","overlay","is","stones","n","length","mask","result","pat","blackCache","whiteCache","cache","compute","patterns","blacks_","appendDummies","whites_","size_","flatMap","p","within","pattern","filter","push","search","map","start","Square","facets","newOrthogonalLines","newDiagonalLines","bsize","direction","lines","toIndex","j","newLine","put","ps","m","Map","has","get","set","l","putMulti","remove","find","d","reverse","toSting","join","toPoint","Array","fill","_","lrow","end","forbidden","square","doubleFour","doubleThree","r","between","newFours","distinct","next","newThrees","trueThrees","t","s","srows","srow","findIndex","adjacent","xd","yd","Math","abs","Board","properties","forbiddensCache","PropertiesProxy","hasStone","bi","q","wi","computeForbiddens","Game","moves","codes","from","matchAll","movable","isBlackTurn","System","windowInnerWidth","N","W","C","P","cx","cy","bx","by","adjust","min","max","round","SystemContext","Rulers","system","useContext","verticalLines","indices","key","className","x1","y1","x2","y2","horizontalLines","Stars","Indices","xIndices","yIndices","dominantBaseline","Default","Forbiddens","points","crosses","c","PropertyRows","prop","PropertyEyes","emphasized","gs","rects","Diamond","transform","width","height","board","forbiddens","Stones","Orders","texts","Stone","LastMarker","state","setState","preference","onClick","base","currentTarget","getBoundingClientRect","clientX","clientY","move","Base","Properties","buttonSize","setPreference","isAllChecked","Popover","placement","IconButton","icon","FiToggleRight","aria-label","variant","zIndex","fontFamily","fontWeight","Flex","justify","align","FormLabel","htmlFor","Switch","id","isChecked","onChange","ResetPopover","onClose","FiLoader","isDisabled","canReset","Button","as","variantColor","reset","justifyContent","alignItems","PreferencePopover","toStart","FiChevronsLeft","isStart","backward","FiChevronLeft","cursor","forward","FiChevronRight","isLast","toLast","FiChevronsRight","undo","FiX","canUndo","FiShare","State","game","split","gameCode","cursorCode","canMove","forked","fork","jump","loadInitialState","windowLocationHash","window","innerWidth","initialState","location","hash","useState","useEffect","history","replaceState","initialPreference","localStorage","getItem","setItem","stringify","usePreference","Provider","value","Stack","spacing","my","Text","textAlign","color","Controller","App","ThemeProvider","CSSReset","Main","Boolean","hostname","match","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","message"],"mappings":"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","file":"static/js/main.2d9c0cb5.chunk.js","sourcesContent":["import { createContext, useState } from 'react'\n\nexport class Preference {\n  readonly showIndices: boolean = false\n  readonly showOrders: boolean = false\n  readonly emphasizeLastMove: boolean = false\n  readonly showForbiddens: boolean = false\n  readonly showPropertyRows: boolean = false\n  readonly showPropertyEyes: boolean = false\n\n  constructor (init: Partial<Preference>) {\n    if (init.showIndices !== undefined) this.showIndices = init.showIndices\n    if (init.showOrders !== undefined) this.showOrders = init.showOrders\n    if (init.emphasizeLastMove !== undefined) this.emphasizeLastMove = init.emphasizeLastMove\n    if (init.showForbiddens !== undefined) this.showForbiddens = init.showForbiddens\n    if (init.showPropertyRows !== undefined) this.showPropertyRows = init.showPropertyRows\n    if (init.showPropertyEyes !== undefined) this.showPropertyEyes = init.showPropertyEyes\n  }\n}\n\nexport type SetPreference = (p: Preference) => void\n\nexport const usePreference = (): [Preference, SetPreference] => {\n  const initialPreference = loadPreference(localStorage.getItem('preference') || '{}')\n  const [preference, setPreference] = useState<Preference>(initialPreference)\n  const setAndSavePreference = (p: Preference) => {\n    setPreference(p)\n    localStorage.setItem('preference', JSON.stringify(p))\n  }\n  return [preference, setAndSavePreference]\n}\n\nexport const PreferenceContext = createContext<[Preference, SetPreference]>([new Preference({}), () => {}])\n\nconst loadPreference = (localStoragePreference: string): Preference => {\n  try {\n    const partial = JSON.parse(localStoragePreference) as Partial<Preference>\n    return new Preference(partial)\n  } catch (e) {\n    console.log(`Invalid preference: '${localStoragePreference}'`)\n    return new Preference({})\n  }\n}\n","export const N_LINES = 15\n\nexport const X_CODES = 'ABCDEFGHIJKLMNO'\n\nexport type Point = [number, number]\n\nexport const equal = (a: Point, b: Point): boolean => a[0] === b[0] && a[1] === b[1]\n\nexport const xCode = (x: number) => X_CODES.charAt(x - 1)\n\nexport const yCode = (x: number) => x.toString()\n\nexport const code = ([x, y]: Point): string => `${xCode(x)}${yCode(y)}`\n\nexport const point = (code: string): Point | undefined => {\n  const x = X_CODES.indexOf(code[0].toUpperCase()) + 1\n  const y = parseInt(code.slice(1))\n  if (x < 1 || N_LINES < x || y < 1 || N_LINES < y) return undefined\n  return [x, y]\n}\n","export type Stones = number // stones as bits, e.g. 0b00111010\n\nexport const rowKinds = ['two', 'closedThree', 'three', 'four', 'five', 'overline'] as const\nexport type RowKind = typeof rowKinds[number]\n\nexport type Row = {\n  readonly kind: RowKind\n  readonly size: number\n  readonly eyes: number[] // index on which the row will promote if a stone is put\n}\n\nexport type RowPattern = {\n  readonly row: Row\n  readonly size: number\n  readonly rowStart: number\n  readonly blacks: Stones\n  readonly blmask: Stones\n  readonly whites: Stones\n  readonly whmask: Stones\n}\n\nexport const search = (blacks: Stones, whites: Stones, within: number, pattern: RowPattern): number[] => {\n  if (within < pattern.size) return []\n  const filter: Stones = 2 ** pattern.size - 1 // e.g. 6 -> 0b111111\n\n  const result: number[] = []\n  for (let i = 0; i <= within - pattern.size; i++) {\n    if (\n      (blacks & filter & ~pattern.blmask) === pattern.blacks &&\n      (whites & filter & ~pattern.whmask) === pattern.whites\n    ) {\n      result.push(i + pattern.rowStart)\n    }\n    blacks >>>= 1\n    whites >>>= 1\n  }\n  return result\n}\n\nconst BLACK_TWO_PATTERNS: RowPattern[] = [\n  {\n    row: { kind: 'two', size: 4, eyes: [2, 3] },\n    size: 8,\n    rowStart: 2,\n    blacks: 0b00001100,\n    whites: 0b00000000,\n    blmask: 0b00000000,\n    whmask: 0b10000001,\n  },\n  {\n    row: { kind: 'two', size: 4, eyes: [1, 3] },\n    size: 8,\n    rowStart: 2,\n    blacks: 0b00010100,\n    whites: 0b00000000,\n    blmask: 0b00000000,\n    whmask: 0b10000001,\n  },\n  {\n    row: { kind: 'two', size: 4, eyes: [0, 3] },\n    size: 8,\n    rowStart: 2,\n    blacks: 0b00011000,\n    whites: 0b00000000,\n    blmask: 0b00000000,\n    whmask: 0b10000001,\n  },\n  {\n    row: { kind: 'two', size: 4, eyes: [1, 2] },\n    size: 8,\n    rowStart: 2,\n    blacks: 0b00100100,\n    whites: 0b00000000,\n    blmask: 0b00000000,\n    whmask: 0b10000001,\n  },\n  {\n    row: { kind: 'two', size: 4, eyes: [0, 2] },\n    size: 8,\n    rowStart: 2,\n    blacks: 0b00101000,\n    whites: 0b00000000,\n    blmask: 0b00000000,\n    whmask: 0b10000001,\n  },\n  {\n    row: { kind: 'two', size: 4, eyes: [0, 1] },\n    size: 8,\n    rowStart: 2,\n    blacks: 0b00110000,\n    whites: 0b00000000,\n    blmask: 0b00000000,\n    whmask: 0b10000001,\n  },\n]\n\nconst BLACK_CLOSED_THREE_PATTERNS: RowPattern[] = [\n  {\n    row: { kind: 'closedThree', size: 5, eyes: [2, 3] },\n    size: 7,\n    rowStart: 1,\n    blacks: 0b0100110,\n    whites: 0b0000000,\n    blmask: 0b0000000,\n    whmask: 0b1000001,\n  },\n  {\n    row: { kind: 'closedThree', size: 5, eyes: [1, 3] },\n    size: 7,\n    rowStart: 1,\n    blacks: 0b0101010,\n    whites: 0b0000000,\n    blmask: 0b0000000,\n    whmask: 0b1000001,\n  },\n  {\n    row: { kind: 'closedThree', size: 5, eyes: [1, 2] },\n    size: 7,\n    rowStart: 1,\n    blacks: 0b0110010,\n    whites: 0b0000000,\n    blmask: 0b0000000,\n    whmask: 0b1000001,\n  },\n  {\n    row: { kind: 'closedThree', size: 5, eyes: [3, 4] },\n    size: 7,\n    rowStart: 1,\n    blacks: 0b0001110,\n    whites: 0b0000001,\n    blmask: 0b0000000,\n    whmask: 0b1000000,\n  },\n  {\n    row: { kind: 'closedThree', size: 5, eyes: [3, 5] },\n    size: 7,\n    rowStart: 1,\n    blacks: 0b0010110,\n    whites: 0b0000001,\n    blmask: 0b0000000,\n    whmask: 0b1000000,\n  },\n  {\n    row: { kind: 'closedThree', size: 5, eyes: [2, 5] },\n    size: 7,\n    rowStart: 1,\n    blacks: 0b0011010,\n    whites: 0b0000001,\n    blmask: 0b0000000,\n    whmask: 0b1000000,\n  },\n  {\n    row: { kind: 'closedThree', size: 5, eyes: [0, 3] },\n    size: 7,\n    rowStart: 1,\n    blacks: 0b0101100,\n    whites: 0b1000000,\n    blmask: 0b0000000,\n    whmask: 0b0000001,\n  },\n  {\n    row: { kind: 'closedThree', size: 5, eyes: [0, 2] },\n    size: 7,\n    rowStart: 1,\n    blacks: 0b0110100,\n    whites: 0b1000000,\n    blmask: 0b0000000,\n    whmask: 0b0000001,\n  },\n  {\n    row: { kind: 'closedThree', size: 5, eyes: [0, 1] },\n    size: 7,\n    rowStart: 1,\n    blacks: 0b0111000,\n    whites: 0b1000000,\n    blmask: 0b0000000,\n    whmask: 0b0000001,\n  },\n  {\n    row: { kind: 'closedThree', size: 5, eyes: [1, 5] },\n    size: 7,\n    rowStart: 1,\n    blacks: 0b0011100,\n    whites: 0b1000001,\n    blmask: 0b0000000,\n    whmask: 0b0000000,\n  },\n]\n\nconst BLACK_THREE_PATTERNS: RowPattern[] = [\n  {\n    row: { kind: 'three', size: 6, eyes: [4] },\n    size: 8,\n    rowStart: 1,\n    blacks: 0b00011100,\n    whites: 0b00000000,\n    blmask: 0b00000000,\n    whmask: 0b10000001,\n  },\n  {\n    row: { kind: 'three', size: 6, eyes: [3] },\n    size: 8,\n    rowStart: 1,\n    blacks: 0b00101100,\n    whites: 0b00000000,\n    blmask: 0b00000000,\n    whmask: 0b10000001,\n  },\n  {\n    row: { kind: 'three', size: 6, eyes: [2] },\n    size: 8,\n    rowStart: 1,\n    blacks: 0b00110100,\n    whites: 0b00000000,\n    blmask: 0b00000000,\n    whmask: 0b10000001,\n  },\n  {\n    row: { kind: 'three', size: 6, eyes: [1] },\n    size: 8,\n    rowStart: 1,\n    blacks: 0b00111000,\n    whites: 0b00000000,\n    blmask: 0b00000000,\n    whmask: 0b10000001,\n  },\n]\n\nconst BLACK_FOUR_PATTERNS: RowPattern[] = [\n  {\n    row: { kind: 'four', size: 5, eyes: [4] },\n    size: 7,\n    rowStart: 1,\n    blacks: 0b0011110,\n    whites: 0b0000000,\n    blmask: 0b0000000,\n    whmask: 0b1000001,\n  },\n  {\n    row: { kind: 'four', size: 5, eyes: [3] },\n    size: 7,\n    rowStart: 1,\n    blacks: 0b0101110,\n    whites: 0b0000000,\n    blmask: 0b0000000,\n    whmask: 0b1000001,\n  },\n  {\n    row: { kind: 'four', size: 5, eyes: [2] },\n    size: 7,\n    rowStart: 1,\n    blacks: 0b0110110,\n    whites: 0b0000000,\n    blmask: 0b0000000,\n    whmask: 0b1000001,\n  },\n  {\n    row: { kind: 'four', size: 5, eyes: [1] },\n    size: 7,\n    rowStart: 1,\n    blacks: 0b0111010,\n    whites: 0b0000000,\n    blmask: 0b0000000,\n    whmask: 0b1000001,\n  },\n  {\n    row: { kind: 'four', size: 5, eyes: [0] },\n    size: 7,\n    rowStart: 1,\n    blacks: 0b0111100,\n    whites: 0b0000000,\n    blmask: 0b0000000,\n    whmask: 0b1000001,\n  },\n]\n\nconst BLACK_FIVE_PATTERNS: RowPattern[] = [\n  {\n    row: { kind: 'five', size: 5, eyes: [] },\n    size: 7,\n    rowStart: 1,\n    blacks: 0b0111110,\n    whites: 0b0000000,\n    blmask: 0b0000000,\n    whmask: 0b1000001,\n  },\n]\n\nconst BLACK_OVERLINE_PATTERNS: RowPattern[] = [\n  {\n    row: { kind: 'overline', size: 6, eyes: [] },\n    size: 6,\n    rowStart: 0,\n    blacks: 0b111111,\n    whites: 0b000000,\n    blmask: 0b000000,\n    whmask: 0b000000,\n  },\n]\n\nconst WHITE_TWO_PATTERNS: RowPattern[] = [\n  {\n    row: { kind: 'two', size: 4, eyes: [2, 3] },\n    size: 6,\n    rowStart: 1,\n    blacks: 0b000000,\n    whites: 0b000110,\n    blmask: 0b000000,\n    whmask: 0b000000,\n  },\n  {\n    row: { kind: 'two', size: 4, eyes: [1, 3] },\n    size: 6,\n    rowStart: 1,\n    blacks: 0b000000,\n    whites: 0b001010,\n    blmask: 0b000000,\n    whmask: 0b000000,\n  },\n  {\n    row: { kind: 'two', size: 4, eyes: [0, 3] },\n    size: 6,\n    rowStart: 1,\n    blacks: 0b000000,\n    whites: 0b001100,\n    blmask: 0b000000,\n    whmask: 0b000000,\n  },\n  {\n    row: { kind: 'two', size: 4, eyes: [1, 2] },\n    size: 6,\n    rowStart: 1,\n    blacks: 0b000000,\n    whites: 0b010010,\n    blmask: 0b000000,\n    whmask: 0b000000,\n  },\n  {\n    row: { kind: 'two', size: 4, eyes: [0, 2] },\n    size: 6,\n    rowStart: 1,\n    blacks: 0b000000,\n    whites: 0b010100,\n    blmask: 0b000000,\n    whmask: 0b000000,\n  },\n  {\n    row: { kind: 'two', size: 4, eyes: [0, 1] },\n    size: 6,\n    rowStart: 1,\n    blacks: 0b000000,\n    whites: 0b011000,\n    blmask: 0b000000,\n    whmask: 0b000000,\n  },\n]\n\nconst WHITE_CLOSED_THREE_PATTERNS: RowPattern[] = [\n  {\n    row: { kind: 'closedThree', size: 5, eyes: [2, 3] },\n    size: 5,\n    rowStart: 0,\n    blacks: 0b00000,\n    whites: 0b10011,\n    blmask: 0b00000,\n    whmask: 0b00000,\n  },\n  {\n    row: { kind: 'closedThree', size: 5, eyes: [1, 3] },\n    size: 5,\n    rowStart: 0,\n    blacks: 0b00000,\n    whites: 0b10101,\n    blmask: 0b00000,\n    whmask: 0b00000,\n  },\n  {\n    row: { kind: 'closedThree', size: 5, eyes: [1, 2] },\n    size: 5,\n    rowStart: 0,\n    blacks: 0b00000,\n    whites: 0b11001,\n    blmask: 0b00000,\n    whmask: 0b00000,\n  },\n  {\n    row: { kind: 'closedThree', size: 5, eyes: [3, 4] },\n    size: 6,\n    rowStart: 1,\n    blacks: 0b000001,\n    whites: 0b001110,\n    blmask: 0b000000,\n    whmask: 0b000000,\n  },\n  {\n    row: { kind: 'closedThree', size: 5, eyes: [3, 5] },\n    size: 6,\n    rowStart: 1,\n    blacks: 0b000001,\n    whites: 0b010110,\n    blmask: 0b000000,\n    whmask: 0b000000,\n  },\n  {\n    row: { kind: 'closedThree', size: 5, eyes: [2, 5] },\n    size: 6,\n    rowStart: 1,\n    blacks: 0b000001,\n    whites: 0b011010,\n    blmask: 0b000000,\n    whmask: 0b000000,\n  },\n  {\n    row: { kind: 'closedThree', size: 5, eyes: [0, 3] },\n    size: 6,\n    rowStart: 0,\n    blacks: 0b100000,\n    whites: 0b010110,\n    blmask: 0b000000,\n    whmask: 0b000000,\n  },\n  {\n    row: { kind: 'closedThree', size: 5, eyes: [0, 2] },\n    size: 6,\n    rowStart: 0,\n    blacks: 0b100000,\n    whites: 0b011010,\n    blmask: 0b000000,\n    whmask: 0b000000,\n  },\n  {\n    row: { kind: 'closedThree', size: 5, eyes: [0, 1] },\n    size: 6,\n    rowStart: 0,\n    blacks: 0b100000,\n    whites: 0b011100,\n    blmask: 0b000000,\n    whmask: 0b000000,\n  },\n  {\n    row: { kind: 'closedThree', size: 5, eyes: [1, 5] },\n    size: 7,\n    rowStart: 1,\n    blacks: 0b1000001,\n    whites: 0b0011100,\n    blmask: 0b0000000,\n    whmask: 0b0000000,\n  },\n]\n\nconst WHITE_THREE_PATTERNS: RowPattern[] = [\n  {\n    row: { kind: 'three', size: 6, eyes: [4] },\n    size: 6,\n    rowStart: 0,\n    blacks: 0b000000,\n    whites: 0b001110,\n    blmask: 0b000000,\n    whmask: 0b000000,\n  },\n  {\n    row: { kind: 'three', size: 6, eyes: [3] },\n    size: 6,\n    rowStart: 0,\n    blacks: 0b000000,\n    whites: 0b010110,\n    blmask: 0b000000,\n    whmask: 0b000000,\n  },\n  {\n    row: { kind: 'three', size: 6, eyes: [2] },\n    size: 6,\n    rowStart: 0,\n    blacks: 0b000000,\n    whites: 0b011010,\n    blmask: 0b000000,\n    whmask: 0b000000,\n  },\n  {\n    row: { kind: 'three', size: 6, eyes: [1] },\n    size: 6,\n    rowStart: 0,\n    blacks: 0b000000,\n    whites: 0b011100,\n    blmask: 0b000000,\n    whmask: 0b000000,\n  },\n]\n\nconst WHITE_FOUR_PATTERNS: RowPattern[] = [\n  {\n    row: { kind: 'four', size: 5, eyes: [4] },\n    size: 5,\n    rowStart: 0,\n    blacks: 0b00000,\n    whites: 0b01111,\n    blmask: 0b00000,\n    whmask: 0b00000,\n  },\n  {\n    row: { kind: 'four', size: 5, eyes: [3] },\n    size: 5,\n    rowStart: 0,\n    blacks: 0b00000,\n    whites: 0b10111,\n    blmask: 0b00000,\n    whmask: 0b00000,\n  },\n  {\n    row: { kind: 'four', size: 5, eyes: [2] },\n    size: 5,\n    rowStart: 0,\n    blacks: 0b00000,\n    whites: 0b11011,\n    blmask: 0b00000,\n    whmask: 0b00000,\n  },\n  {\n    row: { kind: 'four', size: 5, eyes: [1] },\n    size: 5,\n    rowStart: 0,\n    blacks: 0b00000,\n    whites: 0b11101,\n    blmask: 0b00000,\n    whmask: 0b00000,\n  },\n  {\n    row: { kind: 'four', size: 5, eyes: [0] },\n    size: 5,\n    rowStart: 0,\n    blacks: 0b00000,\n    whites: 0b11110,\n    blmask: 0b00000,\n    whmask: 0b00000,\n  },\n]\n\nconst WHITE_FIVE_PATTERNS: RowPattern[] = [\n  {\n    row: { kind: 'five', size: 5, eyes: [] },\n    size: 5,\n    rowStart: 0,\n    blacks: 0b00000,\n    whites: 0b11111,\n    blmask: 0b00000,\n    whmask: 0b00000,\n  }\n]\n\nexport const BLACK_PATTERNS: Record<RowKind, RowPattern[]> = {\n  two: BLACK_TWO_PATTERNS,\n  closedThree: BLACK_CLOSED_THREE_PATTERNS,\n  three: BLACK_THREE_PATTERNS,\n  four: BLACK_FOUR_PATTERNS,\n  five: BLACK_FIVE_PATTERNS,\n  overline: BLACK_OVERLINE_PATTERNS,\n}\n\nexport const WHITE_PATTERNS: Record<RowKind, RowPattern[]> = {\n  two: WHITE_TWO_PATTERNS,\n  closedThree: WHITE_CLOSED_THREE_PATTERNS,\n  three: WHITE_THREE_PATTERNS,\n  four: WHITE_FOUR_PATTERNS,\n  five: WHITE_FIVE_PATTERNS,\n  overline: [],\n}\n\nexport const emptyRowsCache = (): Record<RowKind, undefined> => ({\n  two: undefined,\n  closedThree: undefined,\n  three: undefined,\n  four: undefined,\n  five: undefined,\n  overline: undefined,\n})\n","import {\n  Stones, RowKind, search, emptyRowsCache,\n  BLACK_PATTERNS, WHITE_PATTERNS,\n} from './row'\n\nconst INT_SIZE = 32\n\nexport class Line {\n  readonly size: number\n  readonly blacks: Stones\n  readonly whites: Stones\n  readonly rows: RowsProxy\n\n  constructor (\n    init:\n      | Pick<Line, 'size'>\n      | Pick<Line, 'size' | 'blacks' | 'whites'>\n  ) {\n    this.size = init.size\n    if (this.size < 1 || this.size > INT_SIZE) throw new Error('Wrong size')\n\n    if ('blacks' in init && 'whites' in init) {\n      if ((init.blacks & init.whites) !== 0b0) throw new Error('Black and white stones are overlapping')\n      this.blacks = init.blacks\n      this.whites = init.whites\n    } else {\n      this.blacks = 0b0\n      this.whites = 0b0\n    }\n\n    this.rows = new RowsProxy(this.size, this.blacks, this.whites)\n  }\n\n  put (black: boolean, i: number): Line {\n    return this.overlay(black, 0b1 << i)\n  }\n\n  putMulti (black: boolean, is: number[]): Line {\n    let stones = 0b0\n    for (let n = 0; n < is.length; n++) {\n      stones |= 0b1 << is[n]\n    }\n    return this.overlay(black, stones)\n  }\n\n  remove (i: number): Line {\n    const mask = 0b1 << i\n    const [blacks, whites] = [this.blacks & ~mask, this.whites & ~mask]\n    if (blacks === this.blacks && whites === this.whites) return this\n    return new Line({ size: this.size, blacks: blacks, whites: whites })\n  }\n\n  private overlay (black: boolean, stones: Stones): Line {\n    if (black) {\n      const [blacks, whites] = [this.blacks | stones, this.whites & ~stones]\n      if (blacks === this.blacks) return this\n      return new Line({ size: this.size, blacks: blacks, whites: whites })\n    } else {\n      const [whites, blacks] = [this.whites | stones, this.blacks & ~stones]\n      if (whites === this.whites) return this\n      return new Line({ size: this.size, blacks: blacks, whites: whites })\n    }\n  }\n\n  toSting (): string {\n    let result = ''\n    for (let i = 0; i < this.size; i++) {\n      const pat = 0b1 << i\n      result += (this.blacks & pat) !== 0b0 ? 'o' : ((this.whites & pat) !== 0b0 ? 'x' : '-')\n    }\n    return result\n  }\n}\n\ntype LineRow = {\n  readonly kind: RowKind\n  readonly start: number\n  readonly size: number\n  readonly eyes: number[]\n}\n\nclass RowsProxy {\n  private readonly size: number\n  private readonly blacks: Stones\n  private readonly whites: Stones\n  private readonly blackCache: Record<RowKind, LineRow[] | undefined>\n  private readonly whiteCache: Record<RowKind, LineRow[] | undefined>\n\n  constructor (size: number, blacks: Stones, whites: Stones) {\n    this.size = size\n    this.blacks = blacks\n    this.whites = whites\n\n    this.blackCache = emptyRowsCache()\n    this.whiteCache = emptyRowsCache()\n  }\n\n  get (black: boolean, kind: RowKind): LineRow[] {\n    const cache = black ? this.blackCache : this.whiteCache\n    if (cache[kind] === undefined) {\n      cache[kind] = this.compute(black, kind)\n    }\n    return cache[kind]!\n  }\n\n  private compute (black: boolean, kind: RowKind): LineRow[] {\n    const patterns = black ? BLACK_PATTERNS[kind] : WHITE_PATTERNS[kind]\n\n    // append dummy opponent stones to both line ends\n    const blacks_ = black ? this.blacks << 1 : appendDummies(this.blacks, this.size)\n    const whites_ = black ? appendDummies(this.whites, this.size) : this.whites << 1\n    const size_ = this.size + 2\n\n    return patterns.flatMap(\n      p => search(blacks_, whites_, size_, p).map(\n        i => {\n          // fix index with dummy\n          const start = i - 1\n          return {\n            kind: p.row.kind,\n            start: start,\n            size: p.row.size,\n            eyes: p.row.eyes.map(e => e + start)\n          }\n        }\n      )\n    )\n  }\n}\n\n// e.g. (0b001110, 6) => 0b10011101\nconst appendDummies = (stones: Stones, size: number): Stones => (stones << 1) | 0b1 | (0b1 << (size + 1))\n","import { Point } from '../foundation'\nimport { Line } from './line'\nimport { RowKind, emptyRowsCache } from './row'\n\nconst directions = ['vertical', 'horizontal', 'ascending', 'descending'] as const\ntype Direction = typeof directions[number]\n\ntype Index = [number, number]\n\ntype Facet = [Direction, Line[]]\n\nexport class Square {\n  readonly size: number\n  readonly facets: Facet[]\n  readonly rows: RowsProxy\n\n  constructor (\n    init:\n      | Pick<Square, 'size'>\n      | Pick<Square, 'size' | 'facets'>\n  ) {\n    this.size = init.size\n\n    if ('facets' in init) {\n      this.facets = init.facets\n    } else {\n      this.facets = [\n        ['vertical', newOrthogonalLines(this.size)],\n        ['horizontal', newOrthogonalLines(this.size)],\n        ['ascending', newDiagonalLines(this.size)],\n        ['descending', newDiagonalLines(this.size)],\n      ]\n    }\n\n    this.rows = new RowsProxy(this.size, this.facets)\n  }\n\n  put (black: boolean, p: Point): Square {\n    const bsize = this.size\n    const facets = this.facets.map(\n      ([direction, lines]) => {\n        const [i, j] = toIndex(p, direction, bsize)\n        const newLine = lines[i].put(black, j)\n        const newLines = [...lines.slice(0, i), newLine, ...lines.slice(i + 1, lines.length)]\n        return [direction, newLines] as Facet\n      }\n    )\n    return new Square({ size: this.size, facets: facets })\n  }\n\n  putMulti (black: boolean, ps: Point[]): Square {\n    const bsize = this.size\n    const facets = this.facets.map(\n      ([direction, lines]) => {\n        const m = new Map<number, number[]>()\n        for (let n = 0; n < ps.length; n++) {\n          const [i, j] = toIndex(ps[n], direction, bsize)\n          if (m.has(i)) {\n            m.get(i)!.push(j)\n          } else {\n            m.set(i, [j])\n          }\n        }\n        const newLines = lines.map(\n          (l, i) => m.has(i) ? l.putMulti(black, m.get(i)!) : l\n        )\n        return [direction, newLines] as Facet\n      }\n    )\n    return new Square({ size: this.size, facets: facets })\n  }\n\n  remove (p: Point): Square {\n    const bsize = this.size\n    const facets = this.facets.map(\n      ([direction, lines]) => {\n        const [i, j] = toIndex(p, direction, bsize)\n        const newLine = lines[i].remove(j)\n        const newLines = [...lines.slice(0, i), newLine, ...lines.slice(i + 1, lines.length)]\n        return [direction, newLines] as Facet\n      }\n    )\n    return new Square({ size: this.size, facets: facets })\n  }\n\n  toString (): string {\n    return this.facets.find(([d, _]) => d === 'horizontal')![1].slice().reverse().map(l => l.toSting()).join('\\n')\n  }\n}\n\nconst toIndex = ([x, y]: Point, direction: Direction, bsize: number): Index => {\n  let i: number, j: number\n  switch (direction) {\n    case 'vertical':\n      return [x - 1, y - 1]\n    case 'horizontal':\n      return [y - 1, x - 1]\n    case 'ascending':\n      i = (x - 1) + (bsize - y)\n      j = i < bsize ? (x - 1) : (y - 1)\n      return [i, j]\n    case 'descending':\n      i = (x - 1) + (y - 1)\n      j = i < bsize ? (x - 1) : (bsize - y)\n      return [i, j]\n  }\n}\n\nconst toPoint = ([i, j]: Index, direction: Direction, bsize: number): Point => {\n  let x: number, y: number\n  switch (direction) {\n    case 'vertical':\n      return [i + 1, j + 1]\n    case 'horizontal':\n      return [j + 1, i + 1]\n    case 'ascending':\n      x = i < bsize ? j + 1 : (i + 1) + (j + 1) - bsize\n      y = i < bsize ? bsize - (i + 1) + (j + 1) : j + 1\n      return [x, y]\n    case 'descending':\n      x = i < bsize ? j + 1 : (i + 1) + (j + 1) - bsize\n      y = i < bsize ? (i + 1) - j : bsize - j\n      return [x, y]\n  }\n}\n\nconst newOrthogonalLines = (size: number): Line[] => new Array(size).fill(null).map(\n  () => new Line({ size })\n)\n\nconst newDiagonalLines = (size: number): Line[] => new Array(size * 2 - 1).fill(null).map(\n  (_, i) => new Line({ size: i < size ? i + 1 : size * 2 - 1 - i })\n)\n\nexport type SquareRow = {\n  readonly kind: RowKind\n  readonly direction: Direction\n  readonly start: Point\n  readonly end: Point\n  readonly eyes: Point[]\n}\n\nclass RowsProxy {\n  private readonly size: number\n  private readonly facets: Facet[]\n  private readonly blackCache: Record<RowKind, SquareRow[] | undefined>\n  private readonly whiteCache: Record<RowKind, SquareRow[] | undefined>\n\n  constructor (size: number, facets: Facet[]) {\n    this.size = size\n    this.facets = facets\n\n    this.blackCache = emptyRowsCache()\n    this.whiteCache = emptyRowsCache()\n  }\n\n  get (black: boolean, kind: RowKind): SquareRow[] {\n    const cache = black ? this.blackCache : this.whiteCache\n    if (cache[kind] === undefined) {\n      cache[kind] = this.compute(black, kind)\n    }\n    return cache[kind]!\n  }\n\n  private compute (black: boolean, kind: RowKind): SquareRow[] {\n    const bsize = this.size\n    return this.facets.flatMap(\n      ([direction, lines]) => lines.flatMap(\n        (l, i) => l.rows.get(black, kind).map(\n          lrow => ({\n            kind: lrow.kind,\n            direction: direction,\n            start: toPoint([i, lrow.start], direction, bsize),\n            end: toPoint([i, lrow.start + lrow.size - 1], direction, bsize),\n            eyes: lrow.eyes.map(j => toPoint([i, j], direction, bsize)),\n          })\n        )\n      )\n    )\n  }\n}\n","import { Point } from '../foundation'\nimport { Square, SquareRow } from './square'\n\nexport const forbiddenKinds = ['doubleThree', 'doubleFour', 'overline'] as const\nexport type ForbiddenKind = typeof forbiddenKinds[number]\n\nexport const forbidden = (square: Square, point: Point): ForbiddenKind | undefined => {\n  if (overline(square, point)) {\n    return 'overline'\n  } else if (doubleFour(square, point)) {\n    return 'doubleFour'\n  } else if (doubleThree(square, point)) {\n    return 'doubleThree'\n  }\n}\n\nconst overline = (square: Square, point: Point): boolean => {\n  const next = square.put(true, point)\n  const newOverlines = next.rows.get(true, 'overline').filter(r => between(point, r))\n  return newOverlines.length > 0\n}\n\nconst doubleFour = (square: Square, point: Point): boolean => {\n  const next = square.put(true, point)\n  const newFours = next.rows.get(true, 'four').filter(r => between(point, r))\n  if (newFours.length < 2) return false\n\n  // checking not open four\n  return distinct(newFours).length >= 2\n}\n\nconst doubleThree = (square: Square, point: Point): boolean => {\n  const next = square.put(true, point)\n  const newThrees = next.rows.get(true, 'three').filter(r => between(point, r))\n  if (newThrees.length < 2) return false\n\n  // checking not fake three\n  const trueThrees = newThrees.filter(t => !forbidden(next, t.eyes[0]))\n  if (trueThrees.length < 2) return false\n\n  // checking not open three\n  return distinct(trueThrees).length >= 2\n}\n\nconst between = (p: Point, r: SquareRow): boolean => {\n  const [s, e] = [r.start, r.end]\n  switch (r.direction) {\n    case 'vertical':\n      return p[0] === s[0] && (s[1] <= p[1] && p[1] <= e[1])\n    case 'horizontal':\n      return p[1] === s[1] && (s[0] <= p[0] && p[0] <= e[0])\n    case 'ascending':\n      return (s[0] <= p[0] && p[0] <= e[0]) && (p[0] - s[0] === p[1] - s[1])\n    case 'descending':\n      return (s[0] <= p[0] && p[0] <= e[0]) && (p[0] - s[0] === s[1] - p[1])\n  }\n}\n\nconst distinct = (srows: SquareRow[]): SquareRow[] => {\n  const result: SquareRow[] = []\n  for (let i = 0; i < srows.length; i++) {\n    const srow = srows[i]\n    if (result.findIndex(r => adjacent(srow, r)) < 0) {\n      result.push(srow)\n    }\n  }\n  return result\n}\n\nconst adjacent = (a: SquareRow, b: SquareRow): boolean => {\n  if (a.direction !== b.direction) return false\n  const [xd, yd] = [a.start[0] - b.start[0], a.start[1] - b.start[1]]\n  switch (a.direction) {\n    case 'vertical':\n      return xd === 0 && Math.abs(yd) === 1\n    case 'horizontal':\n      return Math.abs(xd) === 1 && yd === 0\n    case 'ascending':\n      return Math.abs(xd) === 1 && xd === yd\n    case 'descending':\n      return Math.abs(xd) === 1 && xd === -yd\n  }\n}\n","import { Point, equal } from '../foundation'\nimport { Square } from './square'\nimport { forbidden } from './forbidden'\nimport { RowKind, emptyRowsCache } from './row'\n\nexport class Board {\n  readonly size: number\n  readonly blacks: Point[]\n  readonly whites: Point[]\n  readonly properties: PropertiesProxy\n\n  private readonly square: Square\n\n  private forbiddensCache: Point[] | undefined\n\n  constructor (\n    init:\n      | Pick<Board, 'size'>\n      | Pick<Board, 'size' | 'blacks' | 'whites'>\n      | Pick<Board, 'size' | 'blacks' | 'whites'> & { square: Square }\n  ) {\n    this.size = init.size\n\n    if ('blacks' in init && 'whites' in init) {\n      this.blacks = init.blacks\n      this.whites = init.whites\n    } else {\n      this.blacks = []\n      this.whites = []\n    }\n\n    if ('square' in init) {\n      this.square = init.square\n    } else {\n      this.square = new Square({ size: this.size }).putMulti(true, this.blacks).putMulti(false, this.whites)\n    }\n\n    this.properties = new PropertiesProxy(this.square)\n  }\n\n  put (black: boolean, p: Point): Board {\n    if (this.hasStone(p)) return this\n    return new Board({\n      size: this.size,\n      blacks: black ? [...this.blacks, p] : this.blacks,\n      whites: black ? this.whites : [...this.whites, p],\n      square: this.square.put(black, p),\n    })\n  }\n\n  remove (p: Point): Board {\n    if (!this.hasStone(p)) return this\n    const bi = this.blacks.findIndex(q => equal(p, q))\n    const wi = this.whites.findIndex(q => equal(p, q))\n    return new Board({\n      size: this.size,\n      blacks: bi >= 0 ? remove(this.blacks, bi) : this.blacks,\n      whites: wi >= 0 ? remove(this.whites, wi) : this.whites,\n      square: this.square.remove(p),\n    })\n  }\n\n  hasStone (p: Point): boolean {\n    return (\n      (this.blacks.findIndex(q => equal(p, q)) >= 0) ||\n      (this.whites.findIndex(q => equal(p, q)) >= 0)\n    )\n  }\n\n  forbidden (p: Point): boolean {\n    return !this.hasStone(p) && forbidden(this.square, p) !== undefined\n  }\n\n  get forbiddens (): Point[] {\n    if (this.forbiddensCache === undefined) {\n      this.forbiddensCache = this.computeForbiddens()\n    }\n    return this.forbiddensCache\n  }\n\n  private computeForbiddens (): Point[] {\n    const result: Point[] = []\n    for (let x = 1; x <= this.size; x++) {\n      for (let y = 1; y <= this.size; y++) {\n        if (this.hasStone([x, y])) continue\n        if (forbidden(this.square, [x, y])) {\n          result.push([x, y])\n        }\n      }\n    }\n    return result\n  }\n\n  toString (): string {\n    return this.square.toString()\n  }\n}\n\nexport type Property = {\n  kind: RowKind\n  start: Point\n  end: Point // inclusive\n  eyes: Point[]\n}\n\nclass PropertiesProxy {\n  private readonly square: Square\n  private readonly blackCache: Record<RowKind, Property[] | undefined>\n  private readonly whiteCache: Record<RowKind, Property[] | undefined>\n\n  constructor (square: Square) {\n    this.square = square\n\n    this.blackCache = emptyRowsCache()\n    this.whiteCache = emptyRowsCache()\n  }\n\n  get (black: boolean, kind: RowKind): Property[] {\n    const cache = black ? this.blackCache : this.whiteCache\n    if (cache[kind] === undefined) {\n      cache[kind] = this.compute(black, kind)\n    }\n    return cache[kind]!\n  }\n\n  private compute (black: boolean, kind: RowKind): Property[] {\n    return this.square.rows.get(black, kind).map(\n      srow => ({\n        kind: srow.kind,\n        start: srow.start,\n        end: srow.end,\n        eyes: srow.eyes,\n      })\n    )\n  }\n}\n\nconst remove = <T>(a: Array<T>, i: number): Array<T> => [...a.slice(0, i), ...a.slice(i + 1, a.length)]\n","import { code, equal, Point, point } from '../foundation'\n\nexport class Game {\n  readonly moves: Point[]\n\n  constructor (init: {} | { code: string } | Pick<Game, 'moves'>) {\n    if ('moves' in init) {\n      this.moves = init.moves\n    } else if ('code' in init) {\n      this.moves = []\n      const codes = Array.from(init.code.matchAll(/[a-zA-Z][0-9]+/g)).map(m => m[0])\n      for (let i = 0; i < codes.length; i++) {\n        const p = point(codes[i])\n        if (p === undefined) throw new Error(`invalid code: ${codes[i]}`)\n        this.moves.push(p)\n      }\n    } else {\n      this.moves = []\n    }\n  }\n\n  move (p: Point): Game | undefined {\n    if (!this.movable(p)) return undefined\n    return new Game({\n      moves: [...this.moves, p],\n    })\n  }\n\n  undo (): Game | undefined {\n    if (this.moves.length === 0) return undefined\n    return new Game({\n      moves: this.moves.slice(0, this.moves.length - 1),\n    })\n  }\n\n  movable (p: Point): boolean {\n    return this.moves.findIndex(q => equal(p, q)) < 0\n  }\n\n  fork (i: number): Game {\n    return new Game({ moves: this.moves.slice(0, i) })\n  }\n\n  get code (): string {\n    return this.moves.map(code).join('')\n  }\n\n  get blacks (): Point[] {\n    return this.moves.filter((_, i) => i % 2 === 0)\n  }\n\n  get whites (): Point[] {\n    return this.moves.filter((_, i) => i % 2 !== 0)\n  }\n\n  get isBlackTurn (): boolean {\n    return this.moves.length % 2 === 0\n  }\n\n  get isFirstTurn (): boolean {\n    return this.isBlackTurn\n  }\n}\n","import { ButtonProps } from '@chakra-ui/core'\nimport { createContext } from 'react'\nimport { code, N_LINES, Point, xCode, yCode } from '../rule'\n\nexport type BoardWidth = 640 | 360 | 320\n\nexport type BoardCoordinate = [number, number]\n\nexport class System {\n  readonly N: number = N_LINES\n  readonly W: BoardWidth\n  readonly C: number // cell size\n  readonly P: number // padding\n\n  constructor (windowInnerWidth: number) {\n    if (windowInnerWidth >= 640) {\n      this.W = 640\n      this.C = 40\n      this.P = 40\n    } else if (windowInnerWidth >= 360) {\n      this.W = 360\n      this.C = 24\n      this.P = 12\n    } else {\n      this.W = 320\n      this.C = 20\n      this.P = 20\n    }\n  }\n\n  cx (x: number): number {\n    return this.P + (x - 1) * this.C\n  }\n\n  cy (y: number): number {\n    return this.P + (this.N - y) * this.C\n  }\n\n  c ([x, y]: Point): BoardCoordinate {\n    return [this.cx(x), this.cy(y)]\n  }\n\n  p ([bx, by]: [number, number]): Point {\n    return [\n      adjust((bx - this.P) / this.C + 1),\n      adjust((this.W - by - this.P) / this.C + 1),\n    ]\n  }\n\n  className (black: boolean): string {\n    return black ? 'black' : 'white'\n  }\n\n  xCode (x: number): string {\n    return xCode(x)\n  }\n\n  yCode (y: number): string {\n    return yCode(y)\n  }\n\n  code ([x, y]: Point): string {\n    return code([x, y])\n  }\n\n  get indices (): number[] {\n    return new Array(this.N).fill(null).map((_, i) => i + 1)\n  }\n\n  get buttonSize (): ButtonProps['size'] {\n    switch (this.W) {\n      case 320:\n        return 'sm'\n      case 360:\n        return 'sm'\n      case 640:\n        return 'lg'\n    }\n  }\n}\n\nconst adjust = (n: number): number => Math.min(Math.max(1, Math.round(n)), N_LINES)\n\nexport const SystemContext = createContext<System>(new System(640))\n","import React, { FC, useContext } from 'react'\nimport { SystemContext } from '../system'\n\ntype DefaultProps = {\n  showIndices: boolean\n}\n\nconst Default: FC<DefaultProps> = ({\n  showIndices,\n}) => {\n  return <g>\n    <Rulers />\n    <Stars />\n    {showIndices && <Indices />}\n  </g>\n}\n\nconst Rulers: FC = () => {\n  const system = useContext(SystemContext)\n  const verticalLines = system.indices.map(\n    (x, key) => <line\n      key={key}\n      className=\"ruler\"\n      x1={system.cx(x)} y1={system.cy(1)} x2={system.cx(x)} y2={system.cy(system.N)}\n    />\n  )\n  const horizontalLines = system.indices.map(\n    (y, key) => <line\n      key={key}\n      className=\"ruler\"\n      x1={system.cx(1)} y1={system.cy(y)} x2={system.cx(system.N)} y2={system.cy(y)}\n    />\n  )\n  return <g>\n    {verticalLines}\n    {horizontalLines}\n  </g>\n}\n\nconst Stars: FC = () => {\n  const system = useContext(SystemContext)\n  const points = [[4, 4], [4, 12], [8, 8], [12, 4], [12, 12]]\n  return <g>\n    {\n      points.map(\n        ([x, y], key) => <circle\n          key={key}\n          className=\"star\"\n          cx={system.cx(x)} cy={system.cy(y)} r={system.C / 10}\n        />\n      )\n    }\n  </g>\n}\n\nconst Indices: FC = () => {\n  const system = useContext(SystemContext)\n  const xIndices = system.indices.map(\n    (x, key) => <text className=\"index\"\n      key={key}\n      x={system.cx(x)} y={system.cy(1) + system.P}\n    >\n      {system.xCode(x)}\n    </text>\n  )\n  const yIndices = system.indices.map(\n    (y, key) => <text className=\"index\"\n      key={key}\n      x={system.P * 3 / 10} y={system.cy(y)}\n      dominantBaseline=\"central\"\n    >\n      {system.yCode(y)}\n    </text>\n  )\n  return <g>\n    { xIndices }\n    { yIndices }\n  </g>\n}\n\nexport default Default\n","import React, { FC, useContext } from 'react'\nimport { Board, Point, Property } from '../../rule'\nimport { SystemContext } from '../system'\n\ntype DefaultProps = {\n  board: Board\n  showForbiddens: boolean\n  showPropertyRows: boolean\n  showPropertyEyes: boolean\n}\n\nconst Default: FC<DefaultProps> = ({\n  board,\n  showForbiddens,\n  showPropertyRows,\n  showPropertyEyes,\n}) => {\n  return <g>\n    {\n      showPropertyRows &&\n      <>\n        <PropertyRows\n          black={true}\n          properties={board.properties.get(true, 'two')}\n        />\n        <PropertyRows\n          black={true}\n          properties={board.properties.get(true, 'closedThree')}\n        />\n        <PropertyRows\n          black={false} properties={board.properties.get(false, 'two')}\n        />\n        <PropertyRows\n          black={false}\n          properties={board.properties.get(false, 'closedThree')}\n        />\n        <PropertyRows\n          black={true}\n          properties={board.properties.get(true, 'three')}\n        />\n        <PropertyRows\n          black={true}\n          properties={board.properties.get(true, 'four')}\n        />\n        <PropertyRows\n          black={false} properties={board.properties.get(false, 'three')}\n        />\n        <PropertyRows\n          black={false} properties={board.properties.get(false, 'four')}\n        />\n      </>\n    }\n    {\n      showPropertyEyes &&\n      <>\n        <PropertyEyes\n          black={true}\n          properties={board.properties.get(true, 'three')}\n        />\n        <PropertyEyes\n          black={true}\n          properties={board.properties.get(true, 'four')}\n          emphasized\n        />\n        <PropertyEyes\n          black={false}\n          properties={board.properties.get(false, 'three')}\n        />\n        <PropertyEyes\n          black={false}\n          properties={board.properties.get(false, 'four')}\n          emphasized\n        />\n      </>\n    }\n    {\n      showForbiddens &&\n      <Forbiddens\n        points={board.forbiddens}\n      />\n    }\n  </g>\n}\n\ntype ForbiddensProps = {\n  points: Point[]\n}\n\nconst Forbiddens: FC<ForbiddensProps> = ({\n  points,\n}) => {\n  const system = useContext(SystemContext)\n  const crosses = points.map(\n    (p, key) => {\n      const [cx, cy] = system.c(p)\n      const r = system.C * 2 / 10\n      const [x1, x2, y1, y2] = [cx - r, cx + r, cy + r, cy - r]\n      return <g key={key} >\n        <line\n          className=\"forbidden\"\n          x1={x1} y1={y1} x2={x2} y2={y2}\n        />\n        <line\n          className=\"forbidden\"\n          x1={x1} y1={y2} x2={x2} y2={y1}\n        />\n      </g>\n    }\n  )\n  return <g>\n    { crosses }\n  </g>\n}\n\ntype PropertiesProps = {\n  black: boolean\n  properties: Property[]\n  emphasized?: boolean | undefined\n}\n\nconst PropertyRows: FC<PropertiesProps> = ({\n  black,\n  properties,\n}) => {\n  const system = useContext(SystemContext)\n  const lines = properties.map(\n    (prop, key) => {\n      const [x1, y1] = system.c(prop.start)\n      const [x2, y2] = system.c(prop.end)\n      return <g key={key}>\n        { (x1 === x2 || y1 === y2) &&\n          <line\n            className=\"propertyRowUnderlay\"\n            x1={x1} y1={y1} x2={x2} y2={y2}\n          />\n        }\n        <line\n          className={`propertyRow ${system.className(black)}`}\n          x1={x1} y1={y1} x2={x2} y2={y2}\n        />\n      </g>\n    }\n  )\n  return <g>\n    { lines }\n  </g>\n}\n\nconst PropertyEyes: FC<PropertiesProps> = ({\n  black,\n  properties,\n  emphasized,\n}) => {\n  const system = useContext(SystemContext)\n  const gs = properties.map(\n    (prop, m) => {\n      const rects = prop.eyes.map(\n        (e, n) => {\n          const [cx, cy] = system.c(e)\n          const r = system.C * 2 / 10\n          return (\n            emphasized\n              ? <Diamond\n                key={n}\n                className={`propertyEye ${system.className(black)} emphasized`}\n                cx={cx} cy={cy} r={r}\n              />\n              : <circle\n                key={n}\n                className={`propertyEye ${system.className(black)}`}\n                cx={cx} cy={cy} r={r}\n              />\n          )\n        }\n      )\n      return <g key={m}>\n        { rects }\n      </g>\n    }\n  )\n  return <g>\n    { gs }\n  </g>\n}\n\nconst Diamond: FC<{className: string; cx: number, cy: number, r: number}> = ({\n  className,\n  cx,\n  cy,\n  r,\n}) => <g transform={`rotate(45, ${cx}, ${cy})`}>\n  <rect\n    className={className}\n    x={cx - r} y={cy - r}\n    width={r * 2} height={r * 2}\n  />\n</g>\n\nexport default Default\n","import React, { FC, useContext } from 'react'\nimport { Point } from '../../rule'\nimport { SystemContext } from '../system'\n\ntype DefaultProps = {\n  moves?: Point[] | undefined\n  stones?: {\n    blacks: Point[]\n    whites: Point[]\n  } | undefined\n  showOrders?: boolean | undefined\n  emphasizeLastMove?: boolean | undefined\n}\n\nconst Default: FC<DefaultProps> = ({\n  moves,\n  stones,\n  showOrders,\n  emphasizeLastMove,\n}) => {\n  if (moves === undefined && stones === undefined) throw new Error('moves or stones required')\n  if (moves === undefined && showOrders) throw new Error('moves required to show orders')\n  if (moves === undefined && emphasizeLastMove) throw new Error('moves required to emphasize last')\n  const blacks = stones ? stones.blacks : moves!.filter((_, i) => i % 2 === 0)\n  const whites = stones ? stones.whites : moves!.filter((_, i) => i % 2 === 1)\n  return <g>\n    {\n      emphasizeLastMove && moves && moves.length >= 1 &&\n      <LastMarker\n        point={moves[moves.length - 1]}\n      />\n    }\n    <Stones\n      black={true}\n      points={blacks}\n    />\n    <Stones\n      black={false}\n      points={whites}\n    />\n    {\n      moves && showOrders &&\n      <Orders\n        moves={moves}\n      />\n    }\n  </g>\n}\n\ntype StonesProps = {\n  black: boolean\n  points: Point[]\n}\n\nconst Stones: FC<StonesProps> = ({\n  black,\n  points,\n}) => {\n  const stones = points.map(\n    (p, key) => <Stone key={key} black={black} point={p} />\n  )\n  return <g>\n    { stones }\n  </g>\n}\n\ntype OrdersProps = {\n  moves: Point[]\n}\n\nconst Orders: FC<OrdersProps> = ({\n  moves,\n}) => {\n  const system = useContext(SystemContext)\n  const texts = moves.map(\n    ([x, y], key) => <text\n      key={key}\n      className={`order ${system.className(key % 2 === 0)}`}\n      x={system.cx(x)} y={system.cy(y)}\n      dominantBaseline=\"central\"\n    >\n      {key + 1}\n    </text>\n  )\n  return <g>\n    { texts }\n  </g>\n}\n\ntype StoneProps = {\n  black: boolean\n  point: Point\n}\n\nconst Stone: FC<StoneProps> = ({\n  black,\n  point,\n}) => {\n  const system = useContext(SystemContext)\n  const [cx, cy] = system.c(point)\n  const r = system.C / 2 * 9 / 10\n  return <circle\n    className={`stone ${system.className(black)}`}\n    cx={cx} cy={cy} r={r}\n  />\n}\n\ntype LastMarkerProps = {\n  point: Point\n}\n\nconst LastMarker: FC<LastMarkerProps> = ({\n  point,\n}) => {\n  const system = useContext(SystemContext)\n  const [cx, cy] = system.c(point)\n  const r = system.C / 2 * 21 / 20\n  return <circle\n    className=\"lastMarker\"\n    cx={cx} cy={cy} r={r}\n  />\n}\n\nexport default Default\n","import React, { FC, useContext } from 'react'\nimport { PreferenceContext } from '../preference'\nimport { State } from '../state'\nimport { SystemContext } from '../system'\nimport Base from './Base'\nimport Properties from './Properties'\nimport Stones from './Stones'\n\ntype DefaultProps = {\n  state: State\n  setState: (s: State) => void\n}\n\nconst Default: FC<DefaultProps> = ({\n  state,\n  setState,\n}) => {\n  const system = useContext(SystemContext)\n  const preference = useContext(PreferenceContext)[0]\n  const onClickBoard = (e: React.MouseEvent<SVGElement, MouseEvent>) => {\n    const base = e.currentTarget.getBoundingClientRect()\n    const [bx, by] = [e.clientX - base.x, e.clientY - base.y]\n    setState(state.move(system.p([bx, by])))\n  }\n  return <svg className=\"rjn-board\" width={system.W} height={system.W} onClick={onClickBoard}>\n    <Base\n      showIndices={preference.showIndices}\n    />\n    <Properties\n      board={state.board}\n      showForbiddens={preference.showForbiddens}\n      showPropertyRows={preference.showPropertyRows}\n      showPropertyEyes={preference.showPropertyEyes}\n    />\n    <Stones\n      moves={state.moves}\n      showOrders={preference.showOrders}\n      emphasizeLastMove={preference.emphasizeLastMove}\n    />\n  </svg>\n}\n\nexport default Default\n","import {\n  ButtonProps, Flex, FormLabel, IconButton,\n  Popover, PopoverArrow, PopoverBody, PopoverContent, PopoverTrigger,\n  Switch\n} from '@chakra-ui/core'\nimport React, { FC, useContext } from 'react'\nimport { FiToggleRight } from 'react-icons/fi'\nimport { PreferenceContext } from '../preference'\n\ntype DefaultProps = {\n  buttonSize: ButtonProps['size']\n}\n\nconst Default: FC<DefaultProps> = ({\n  buttonSize,\n}) => {\n  const [preference, setPreference] = useContext(PreferenceContext)\n  const isAllChecked = (\n    preference.showIndices &&\n    preference.showOrders &&\n    preference.emphasizeLastMove &&\n    preference.showForbiddens &&\n    preference.showPropertyRows &&\n    preference.showPropertyEyes\n  )\n  return (\n    <Popover\n      placement=\"bottom\"\n    >\n      <PopoverTrigger>\n        <IconButton\n          size={buttonSize}\n          icon={FiToggleRight} aria-label=\"preference\"\n          variant=\"ghost\"\n        />\n      </PopoverTrigger>\n      <PopoverContent\n        zIndex={4}\n      >\n        <PopoverArrow />\n        <PopoverBody fontFamily=\"Noto Sans\" fontWeight=\"normal\">\n          <Flex justify=\"space-between\" align=\"center\">\n            <FormLabel htmlFor=\"controller-preference-all\">All</FormLabel>\n            <Switch\n              id=\"controller-preference-all\"\n              isChecked={isAllChecked}\n              onChange={() => {\n                if (isAllChecked) {\n                  setPreference({\n                    showIndices: false,\n                    showOrders: false,\n                    emphasizeLastMove: false,\n                    showForbiddens: false,\n                    showPropertyRows: false,\n                    showPropertyEyes: false,\n                  })\n                } else {\n                  setPreference({\n                    showIndices: true,\n                    showOrders: true,\n                    emphasizeLastMove: true,\n                    showForbiddens: true,\n                    showPropertyRows: true,\n                    showPropertyEyes: true,\n                  })\n                }\n              }}\n            />\n          </Flex>\n          <Flex justify=\"space-between\" align=\"center\">\n            <FormLabel htmlFor=\"controller-preference-show-indices\">Line indices</FormLabel>\n            <Switch\n              id=\"controller-preference-show-indices\"\n              isChecked={preference.showIndices}\n              onChange={() => setPreference({ ...preference, showIndices: !preference.showIndices })}\n            />\n          </Flex>\n          <Flex justify=\"space-between\" align=\"center\">\n            <FormLabel htmlFor=\"controller-preference-show-orders\">Move orders</FormLabel>\n            <Switch\n              id=\"controller-preference-show-orders\"\n              isChecked={preference.showOrders}\n              onChange={() => setPreference({ ...preference, showOrders: !preference.showOrders })}\n            />\n          </Flex>\n          <Flex justify=\"space-between\" align=\"center\">\n            <FormLabel htmlFor=\"controller-preference-emphasize-last-move\">Last move</FormLabel>\n            <Switch\n              id=\"controller-preference-emphasize-last-move\"\n              isChecked={preference.emphasizeLastMove}\n              onChange={() => setPreference({ ...preference, emphasizeLastMove: !preference.emphasizeLastMove })}\n            />\n          </Flex>\n          <Flex justify=\"space-between\" align=\"center\">\n            <FormLabel htmlFor=\"controller-preference-show-forbiddens\">Forbiddens</FormLabel>\n            <Switch\n              id=\"controller-preference-show-forbiddens\"\n              isChecked={preference.showForbiddens}\n              onChange={() => setPreference({ ...preference, showForbiddens: !preference.showForbiddens })}\n            />\n          </Flex>\n          <Flex justify=\"space-between\" align=\"center\">\n            <FormLabel htmlFor=\"controller-preference-show-property-eyes\">Row eyes</FormLabel>\n            <Switch id=\"controller-preference-show-property-eyes\"\n              isChecked={preference.showPropertyEyes}\n              onChange={() => setPreference({ ...preference, showPropertyEyes: !preference.showPropertyEyes })}\n            />\n          </Flex>\n          <Flex justify=\"space-between\" align=\"center\">\n            <FormLabel htmlFor=\"controller-preference-show-property-rows\">Row lines</FormLabel>\n            <Switch\n              id=\"controller-preference-show-property-rows\"\n              isChecked={preference.showPropertyRows}\n              onChange={() => setPreference({ ...preference, showPropertyRows: !preference.showPropertyRows })}\n            />\n          </Flex>\n        </PopoverBody>\n      </PopoverContent>\n    </Popover>\n  )\n}\n\nexport default Default\n","import {\n  Button, ButtonProps, Flex, IconButton,\n  Popover, PopoverArrow, PopoverContent, PopoverTrigger\n} from '@chakra-ui/core'\nimport React, { FC, useContext } from 'react'\nimport {\n  FiChevronLeft, FiChevronRight, FiChevronsLeft, FiChevronsRight,\n  FiLoader, FiShare, FiX\n} from 'react-icons/fi'\nimport { State } from '../state'\nimport { SystemContext } from '../system'\nimport PreferencePopover from './PreferencePopover'\n\ntype DefaultProps = {\n  state: State\n  setState: (s: State) => void\n}\n\nconst Default: FC<DefaultProps> = ({\n  state,\n  setState,\n}) => {\n  const system = useContext(SystemContext)\n  return <Flex width={system.W} justifyContent=\"space-around\" alignItems=\"center\">\n    <PreferencePopover\n      buttonSize={system.buttonSize}\n    />\n    <ResetPopover\n      state={state}\n      setState={setState}\n      buttonSize={system.buttonSize}\n    />\n    <Flex justifyContent=\"center\" alignItems=\"center\">\n      <IconButton\n        onClick={() => setState(state.toStart())}\n        icon={FiChevronsLeft} aria-label=\"to start\"\n        size={system.buttonSize}\n        variant=\"ghost\"\n        isDisabled={state.isStart}\n      />\n      <IconButton\n        onClick={() => setState(state.backward())}\n        icon={FiChevronLeft} aria-label=\"backward\"\n        size={system.buttonSize}\n        variant=\"ghost\"\n        isDisabled={state.isStart}\n      />\n      <Button\n        width={6} // do not resize according to text\n        size={system.buttonSize}\n        variant=\"ghost\" fontFamily=\"Noto Serif\" fontWeight=\"normal\"\n        isDisabled={true}\n      >\n        {state.cursor}\n      </Button>\n      <IconButton\n        onClick={() => setState(state.forward())}\n        icon={FiChevronRight} aria-label=\"forward\"\n        size={system.buttonSize}\n        variant=\"ghost\"\n        isDisabled={state.isLast}\n      />\n      <IconButton\n        onClick={() => setState(state.toLast())}\n        icon={FiChevronsRight} aria-label=\"to last\"\n        size={system.buttonSize}\n        variant=\"ghost\"\n        isDisabled={state.isLast}\n      />\n    </Flex>\n    <IconButton\n      onClick={() => setState(state.undo())}\n      icon={FiX} aria-label=\"undo\"\n      size={system.buttonSize}\n      variant=\"ghost\"\n      isDisabled={!state.canUndo}\n    />\n    <IconButton\n      icon={FiShare} aria-label=\"share\"\n      size={system.buttonSize}\n      variant=\"ghost\"\n      isDisabled={true}\n    />\n  </Flex>\n}\n\ntype ResetPopoverProps = {\n  state: State\n  setState: (s: State) => void\n  buttonSize: ButtonProps['size']\n}\n\nconst ResetPopover: FC<ResetPopoverProps> = ({\n  state,\n  setState,\n  buttonSize,\n}) => {\n  return (\n    <Popover\n      placement=\"bottom\"\n    >\n      {\n        ({ onClose }) => (\n          <>\n            <PopoverTrigger>\n              <IconButton\n                icon={FiLoader} aria-label=\"reset\"\n                size={buttonSize}\n                variant=\"ghost\"\n                isDisabled={!state.canReset}\n              />\n            </PopoverTrigger>\n            <PopoverContent\n              zIndex={4}\n              width={16}\n            >\n              <PopoverArrow />\n              <Button\n                as=\"button\"\n                size=\"sm\"\n                variant=\"ghost\"\n                variantColor=\"red\"\n                fontFamily=\"Noto Sans\" fontWeight=\"normal\"\n                onClick={() => {\n                  setState(state.reset())\n                  if (onClose) onClose()\n                }}\n              >\n                RESET\n              </Button>\n            </PopoverContent>\n          </>\n        )\n      }\n    </Popover>\n  )\n}\n\nexport default Default\n","import { Board, Game, N_LINES, Point } from '../rule'\n\nexport class State {\n  readonly game: Game\n  readonly cursor: number\n  readonly board: Board\n\n  constructor (init: {} | {code: string} | Pick<State, 'game' | 'cursor' | 'board'>) {\n    if ('game' in init) {\n      this.game = init.game\n      this.cursor = init.cursor\n      this.board = init.board\n    } else if ('code' in init) {\n      const codes = init.code.split('/')\n      if (codes.length !== 2) throw new Error('invalid code')\n      const [gameCode, cursorCode] = codes\n      this.game = new Game({ code: gameCode })\n      this.cursor = parseInt(cursorCode)\n      this.board = new Board({ size: N_LINES, blacks: this.game.blacks, whites: this.game.whites })\n    } else {\n      this.game = new Game({})\n      this.cursor = 0\n      this.board = new Board({ size: N_LINES })\n    }\n  }\n\n  move (p: Point): State {\n    if (!this.canMove) return this\n    if (this.game.isBlackTurn && this.board.forbidden(p)) return this\n\n    const game = this.game.move(p)\n    if (game === undefined) return this\n    return new State({\n      game: game,\n      board: this.board.put(this.game.isBlackTurn, p),\n      cursor: this.cursor + 1,\n    })\n  }\n\n  undo (): State {\n    if (!this.canUndo) return this\n\n    const game = this.game.undo()\n    if (game === undefined) return this\n    return new State({\n      game: game,\n      board: this.board.remove(this.game.moves[this.game.moves.length - 1]),\n      cursor: this.cursor - 1,\n    })\n  }\n\n  reset (): State {\n    if (!this.canReset) return this\n    return new State({})\n  }\n\n  forward (): State {\n    if (this.isLast) return this\n    return new State({\n      game: this.game,\n      board: this.board.put(this.cursor % 2 === 0, this.game.moves[this.cursor]),\n      cursor: this.cursor + 1,\n    })\n  }\n\n  backward (): State {\n    if (this.isStart) return this\n    return new State({\n      game: this.game,\n      board: this.board.remove(this.game.moves[this.cursor - 1]),\n      cursor: this.cursor - 1,\n    })\n  }\n\n  jump (i: number): State {\n    if (i < 0 || this.game.moves.length < i) return this\n    const forked = this.game.fork(i)\n    return new State({\n      game: this.game,\n      board: new Board({\n        size: this.board.size,\n        blacks: forked.blacks,\n        whites: forked.whites,\n      }),\n      cursor: i,\n    })\n  }\n\n  toStart (): State {\n    return this.jump(0)\n  }\n\n  toLast (): State {\n    return this.jump(this.game.moves.length)\n  }\n\n  get isStart (): boolean {\n    return this.cursor === 0\n  }\n\n  get isLast (): boolean {\n    return this.cursor === this.game.moves.length\n  }\n\n  get canMove (): boolean {\n    return this.isLast\n  }\n\n  get canUndo (): boolean {\n    return this.isLast && !this.isStart\n  }\n\n  get canReset (): boolean {\n    return this.game.moves.length > 0\n  }\n\n  get moves (): Point[] {\n    return this.game.moves.slice(0, this.cursor)\n  }\n\n  get code (): string {\n    return `${this.game.code}/${this.cursor}`\n  }\n}\n","import { Flex, Stack, Text } from '@chakra-ui/core'\nimport React, { FC, useEffect, useState } from 'react'\nimport Board from './Board'\nimport Controller from './Controller'\nimport { PreferenceContext, usePreference } from './preference'\nimport { State } from './state'\nimport { System, SystemContext } from './system'\n\nconst Default: FC = () => {\n  const system = new System(window.innerWidth)\n  const initialState = loadInitialState(window.location.hash)\n  const [state, setState] = useState<State>(initialState)\n  useEffect(\n    () => {\n      window.history.replaceState(null, '', `#${state.code}`)\n    },\n    [state.code]\n  )\n\n  const [preference, setPreference] = usePreference()\n  useEffect(\n    () => setPreference(preference),\n    [preference],\n  )\n  return (\n    <SystemContext.Provider value={system}>\n      <PreferenceContext.Provider value={[preference, setPreference]}>\n        <Flex justify=\"center\">\n          <Stack spacing={4} my={2}>\n            <Flex justify=\"center\" align=\"center\">\n              <Text\n                as=\"h1\" textAlign=\"center\"\n                fontFamily=\"Noto Sans\" fontWeight=\"normal\" color=\"gray.500\"\n              >\n            Renju Note BETA\n              </Text>\n            </Flex>\n            <Flex justify=\"center\" align=\"center\">\n              <Board\n                state={state}\n                setState={setState}\n              />\n            </Flex>\n            <Flex justify=\"center\" align=\"center\">\n              <Controller\n                state={state}\n                setState={setState}\n              />\n            </Flex>\n          </Stack>\n        </Flex>\n      </PreferenceContext.Provider>\n    </SystemContext.Provider>\n  )\n}\n\nconst loadInitialState = (windowLocationHash: string): State => {\n  try {\n    return new State({ code: windowLocationHash.slice(1) })\n  } catch (e) {\n    console.log(`Invalid fragment: '${windowLocationHash}'`)\n    return new State({})\n  }\n}\n\nexport default Default\n","import { CSSReset, ThemeProvider } from '@chakra-ui/core'\nimport React, { FC } from 'react'\nimport './App.css'\nimport Main from './Main'\n\nconst App: FC = () => {\n  return <ThemeProvider>\n    <CSSReset />\n    <Main />\n  </ThemeProvider>\n}\n\nexport default App\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n)\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register (config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    )\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config)\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          )\n        })\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config)\n      }\n    })\n  }\n}\n\nfunction registerValidSW (swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing\n        if (installingWorker == null) {\n          return\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              )\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration)\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.')\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration)\n              }\n            }\n          }\n        }\n      }\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error)\n    })\n}\n\nfunction checkValidServiceWorker (swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type')\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload()\n          })\n        })\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config)\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      )\n    })\n}\n\nexport function unregister () {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister()\n      })\n      .catch(error => {\n        console.error(error.message)\n      })\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport App from './components/App'\nimport * as serviceWorker from './serviceWorker'\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n)\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister()\n"],"sourceRoot":""}